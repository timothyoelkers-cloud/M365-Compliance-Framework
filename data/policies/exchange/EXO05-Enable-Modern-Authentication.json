{
  "_metadata": {
    "id": "EXO05",
    "title": "Enable Modern Authentication (OAuth 2.0)",
    "description": "Explicitly enables Modern Authentication (OAuth 2.0) for Exchange Online via Set-OrganizationConfig. Modern auth supports MFA, certificate-based auth, conditional access, and token-based authentication. This must be enabled before disabling basic auth (EXO04).",
    "frameworks": [
      "CIS Microsoft 365 v3.1.0",
      "NIST SP 800-53 Rev 5",
      "NIS2",
      "DORA",
      "ISO 27001:2022",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "PCI DSS v4.0",
      "HIPAA",
      "FedRAMP Moderate",
      "GDPR (EU) 2016/679",
      "CMMC v2.0",
      "HITRUST CSF v11",
      "NYDFS 23 NYCRR 500",
      "FFIEC-CAT",
      "Microsoft Cloud Security Benchmark"
    ],
    "cisChecks": ["6.1.2"],
    "severity": "Critical",
    "category": "Exchange Online",
    "deploymentOrder": 3,
    "requiredLicence": "Exchange Online (included with Microsoft 365)",
    "version": "2.0",
    "lastUpdated": "2026-02-27",
    "_notes": "Modern Authentication is enabled by default in tenants created after August 2017. This policy explicitly sets it to ensure it has not been disabled. Deploy this BEFORE EXO04 (Disable Basic Authentication). OAuth2ClientProfileEnabled must be true for Outlook clients to use modern auth. After enabling, verify Outlook prompts for modern auth (browser-based sign-in window) rather than basic auth (inline credential dialog)."
  },
  "cmdlet": "Set-OrganizationConfig",
  "parameters": {
    "OAuth2ClientProfileEnabled": true
  },
  "postDeployment": [
    "Get-OrganizationConfig | Select-Object OAuth2ClientProfileEnabled",
    "Verify Outlook clients receive the modern auth prompt (browser-based sign-in) rather than the legacy credential dialog",
    "Ensure Outlook 2016 or later is deployed to all workstations (older versions may not support modern auth without registry modifications)",
    "After confirming modern auth is working for all users, proceed with EXO04 (Disable Basic Authentication)"
  ]
}
