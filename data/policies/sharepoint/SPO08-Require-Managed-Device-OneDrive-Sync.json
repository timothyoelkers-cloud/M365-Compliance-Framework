{
  "_metadata": {
    "id": "SPO08",
    "title": "Require Managed Device for OneDrive Sync",
    "description": "Restricts OneDrive and SharePoint file sync to devices that are domain-joined to specific Active Directory domains or Intune-compliant. Prevents the OneDrive sync client from syncing corporate data to unmanaged personal devices.",
    "frameworks": [
      "CIS Microsoft 365 v3.1.0",
      "NIST SP 800-53 Rev 5",
      "NIS2",
      "DORA",
      "ISO 27001:2022",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "CMMC v2.0",
      "FedRAMP Moderate",
      "GDPR (EU) 2016/679",
      "HITRUST CSF v11",
      "Microsoft Cloud Security Benchmark"
    ],
    "cisChecks": [
      "7.2.10"
    ],
    "severity": "High",
    "category": "SharePoint Online",
    "deploymentOrder": 8,
    "requiredLicence": "SharePoint Online + Entra ID P1 (for device management)",
    "version": "2.0",
    "lastUpdated": "2026-02-27",
    "_notes": "AllowedDomainListForSyncClient restricts which AD domain GUIDs can sync. The GUID is your Active Directory domain GUID (not the Entra ID tenant ID). Retrieve it with: (Get-ADDomain).ObjectGUID. For Intune-only environments, use TenantRestrictionEnabled and IsUnmanagedSyncClientRestricted instead. SyncClientRestrictionType: DomainRestriction enforces the domain GUID list. Users on non-domain-joined devices will see the sync button but syncing will fail with an error."
  },
  "cmdlet": "Set-SPOTenant",
  "parameters": {
    "OneDriveStorageQuota": 1048576,
    "AllowedDomainListForSyncClient": [],
    "BlockMacSync": false,
    "IsUnmanagedSyncClientForTenantRestricted": true
  },
  "postDeployment": [
    "Get-SPOTenant | Select-Object AllowedDomainListForSyncClient, IsUnmanagedSyncClientForTenantRestricted",
    "Retrieve your AD domain GUID: PowerShell (on-premises AD): (Get-ADDomain).ObjectGUID",
    "Replace  with the actual Active Directory domain GUID",
    "Test from an unmanaged device: the OneDrive sync client should fail to sync with an error message",
    "Test from a managed (domain-joined) device: syncing should work normally",
    "If using multiple AD domains or forests, add all domain GUIDs to the AllowedDomainListForSyncClient array",
    "For Mac devices, set BlockMacSync to true if Macs are not managed in your environment"
  ]
}