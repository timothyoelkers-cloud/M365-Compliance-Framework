{
  "_metadata": {
    "id": "SPO02",
    "title": "Set Default Sharing Link - Internal Only",
    "description": "Changes the default sharing link type from 'Anyone with the link' to 'People in your organization'. Sets the default permission to View-only. Users can still choose other link types, but the default prevents accidental oversharing.",
    "frameworks": [
      "CIS Microsoft 365 v3.1.0",
      "NIST SP 800-53 Rev 5",
      "NIS2",
      "ISO 27001:2022",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "PCI DSS v4.0",
      "HIPAA",
      "FedRAMP Moderate",
      "GDPR (EU) 2016/679",
      "CMMC v2.0",
      "HITRUST CSF v11",
      "ASD Essential Eight",
      "Microsoft Cloud Security Benchmark"
    ],
    "cisChecks": ["7.2.4"],
    "severity": "Medium",
    "category": "SharePoint Online",
    "deploymentOrder": 2,
    "requiredLicence": "SharePoint Online (included with Microsoft 365)",
    "version": "2.0",
    "lastUpdated": "2026-02-27",
    "_notes": "This changes the DEFAULT link type only. Users can still manually select other link types (specific people, anyone, etc.) when sharing. DefaultSharingLinkType: Internal means 'People in your organization' is pre-selected. DefaultLinkPermission: View means view-only is the default permission (users must explicitly choose Edit). This reduces accidental oversharing without blocking legitimate use cases."
  },
  "cmdlet": "Set-SPOTenant",
  "parameters": {
    "DefaultSharingLinkType": "Internal",
    "DefaultLinkPermission": "View"
  },
  "postDeployment": [
    "Get-SPOTenant | Select-Object DefaultSharingLinkType, DefaultLinkPermission",
    "Verify in the SharePoint UI that the default sharing dialog shows 'People in <org>' and 'Can view' as defaults",
    "Communicate to users that the default sharing behavior has changed; they can still select other link types as needed",
    "Consider also setting per-site defaults for sensitive site collections: Set-SPOSite -Identity <url> -DefaultSharingLinkType Internal -DefaultLinkPermission View"
  ]
}
