{
  "_metadata": {
    "id": "DEF02",
    "title": "Safe Links - All Applications",
    "description": "Enables Safe Links URL scanning and detonation for email, Microsoft Teams, and Office desktop/mobile apps. Blocks click-through to malicious URLs, rewrites URLs for tracking, and scans links at time of click.",
    "frameworks": [
      "CIS Microsoft 365 v3.1.0",
      "NIST SP 800-53 Rev 5",
      "MITRE ATT&CK T1566.002",
      "NIS2",
      "DORA",
      "ISO 27001:2022",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "PCI DSS v4.0",
      "HIPAA",
      "HITRUST CSF v11",
      "CMMC v2.0",
      "FedRAMP Moderate",
      "GDPR (EU) 2016/679",
      "ASD Essential Eight",
      "Microsoft Cloud Security Benchmark"
    ],
    "cisChecks": [
      "2.1.5",
      "2.1.11",
      "2.4.1",
      "2.4.3",
      "2.4.4"
    ],
    "severity": "High",
    "category": "Defender for Office 365",
    "deploymentOrder": 2,
    "requiredLicence": "Microsoft Defender for Office 365 Plan 1 or Plan 2",
    "version": "2.0",
    "lastUpdated": "2026-02-27",
    "_notes": "Requires Defender for Office 365 P1/P2. Safe Links scanning applies at time of click, not time of delivery. DeliverMessageAfterScan ensures URLs are scanned before the user can click. DisableUrlRewrite: false ensures URLs are wrapped for real-time protection."
  },
  "steps": [
    {
      "cmdlet": "New-SafeLinksPolicy",
      "parameters": {
        "Name": "Safe Links - All Applications",
        "EnableSafeLinksForEmail": true,
        "EnableSafeLinksForTeams": true,
        "EnableSafeLinksForOffice": true,
        "TrackClicks": true,
        "AllowClickThrough": false,
        "ScanUrls": true,
        "EnableForInternalSenders": true,
        "DeliverMessageAfterScan": true,
        "DisableUrlRewrite": false,
        "EnableOrganizationBranding": false,
        "DoNotRewriteUrls": [],
        "CustomNotificationText": "",
        "EnableSafeLinksForO365Clients": true
      }
    },
    {
      "cmdlet": "New-SafeLinksRule",
      "parameters": {
        "Name": "Safe Links Rule - All Recipients",
        "SafeLinksPolicy": "Safe Links - All Applications",
        "RecipientDomainIs": [],
        "Enabled": true,
        "Priority": 0
      }
    }
  ],
  "postDeployment": [
    "Get-SafeLinksPolicy -Identity 'Safe Links - All Applications' | Format-List",
    "Get-SafeLinksRule -Identity 'Safe Links Rule - All Recipients' | Format-List",
    "Add any legitimate URLs that must not be rewritten to DoNotRewriteUrls (use sparingly)",
    "Verify Safe Links is functioning by sending a test email with a known-safe URL and checking URL rewriting"
  ]
}