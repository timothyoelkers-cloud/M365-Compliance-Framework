{
  "_metadata": {
    "id": "PV16",
    "title": "DLP - Block Australian PII Shared Externally",
    "description": "Data Loss Prevention policy that detects and blocks Australian Personally Identifiable Information (Tax File Numbers, Medicare Numbers, and Driver's Licence Numbers) from being shared with external recipients across Exchange, SharePoint, OneDrive, and Teams.",
    "version": "1.0",
    "lastUpdated": "2026-02-28",
    "frameworks": [
      "ASD Essential Eight",
      "NIS2",
      "ISO 27001:2022",
      "NIST SP 800-53 Rev.5",
      "SOC 2",
      "GDPR (EU) 2016/679",
      "Microsoft Cloud Security Benchmark",
      "HIPAA",
      "PCI DSS v4.0",
      "BSI IT-Grundschutz"
    ],
    "cisChecks": [
      "9.1.2",
      "9.1.3"
    ],
    "mitreMappings": [
      "T1048",
      "T1567",
      "T1041"
    ],
    "requiredLicences": [
      "Microsoft 365 E3 (basic DLP)",
      "Microsoft 365 E5 or Microsoft 365 E5 Compliance (advanced DLP)",
      "Microsoft Purview Data Loss Prevention add-on"
    ],
    "requiredRoles": [
      "Compliance Administrator",
      "Security Administrator"
    ],
    "deploymentOrder": 16,
    "importMethod": "powershell-security-compliance",
    "importScript": "scripts/Import-PurviewPolicies.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Connect to Security & Compliance PowerShell: Connect-IPPSSession",
      "DLP licensing must be assigned to all users in scope",
      "Deploy in TestWithNotifications mode first, then switch to Enable after validation",
      "Ensure Exchange Online, SharePoint Online, and Teams services are active",
      "Australian SIT definitions are built-in and require no additional configuration"
    ],
    "deploymentSteps": [
      "1. Connect to Security & Compliance PowerShell",
      "2. Run the New-DlpCompliancePolicy cmdlet to create the policy",
      "3. Run the New-DlpComplianceRule cmdlet to create the detection rule",
      "4. Set Mode to TestWithNotifications for initial 2-week pilot",
      "5. Review DLP reports in compliance.microsoft.com > Reports > DLP",
      "6. After validation, change Mode to Enable for enforcement"
    ],
    "rollbackProcedure": "Set-DlpCompliancePolicy -Identity 'PV16-DLP-Block-AustralianPII-External' -Mode Disable"
  },
  "powershellCommands": {
    "createPolicy": {
      "cmdlet": "New-DlpCompliancePolicy",
      "parameters": {
        "Name": "PV16-DLP-Block-AustralianPII-External",
        "Comment": "Blocks Australian PII (TFN, Medicare, Driver Licence) from being shared externally across Exchange, SharePoint, OneDrive, and Teams. ASD Essential Eight and Privacy Act 1988 compliance.",
        "ExchangeLocation": [
          "All"
        ],
        "SharePointLocation": [
          "All"
        ],
        "OneDriveLocation": [
          "All"
        ],
        "TeamsLocation": [
          "All"
        ],
        "Mode": "TestWithNotifications",
        "Priority": 0
      }
    },
    "createRule": {
      "cmdlet": "New-DlpComplianceRule",
      "parameters": {
        "Name": "PV16-Rule-Block-AustralianPII-External",
        "Policy": "PV16-DLP-Block-AustralianPII-External",
        "ContentContainsSensitiveInformation": [
          {
            "name": "Australia Tax File Number",
            "id": "e29bc2e7-0f62-4127-b0f9-30866117c386",
            "minCount": 1,
            "maxCount": -1,
            "minConfidence": 85,
            "maxConfidence": 100
          },
          {
            "name": "Australia Medicare Number",
            "id": "9ee8dba5-0e27-4847-a093-1fc69faf0a2c",
            "minCount": 1,
            "maxCount": -1,
            "minConfidence": 75,
            "maxConfidence": 100
          },
          {
            "name": "Australia Driver's License Number",
            "id": "1cbbc8f5-9216-4e2b-a6af-c35ab3b7fc2f",
            "minCount": 1,
            "maxCount": -1,
            "minConfidence": 75,
            "maxConfidence": 100
          }
        ],
        "AccessScope": "NotInOrganization",
        "BlockAccess": true,
        "BlockAccessScope": "ExternalUsers",
        "NotifyUser": [
          "SiteAdmin",
          "LastModifier"
        ],
        "NotifyUserType": "NotifyAll",
        "NotifyPolicyTipCustomText": "This content contains Australian personal information (TFN, Medicare, or Driver Licence) and cannot be shared externally. Please remove the sensitive data or contact your compliance team for assistance.",
        "GenerateAlert": "SiteAdmin",
        "AlertProperties": {
          "AggregationType": "SimpleAggregation",
          "Threshold": 1,
          "TimeWindow": 60
        },
        "GenerateIncidentReport": [],
        "IncidentReportContent": [
          "Title",
          "DocumentAuthor",
          "DocumentLastModifier",
          "Service",
          "MatchedItem",
          "RulesMatched",
          "Severity"
        ],
        "ReportSeverityLevel": "High"
      }
    }
  },
  "sensitiveInformationTypes": [
    {
      "name": "Australia Tax File Number",
      "id": "e29bc2e7-0f62-4127-b0f9-30866117c386",
      "description": "Detects Australian Tax File Numbers (TFN) - a unique 8 or 9 digit number issued by the ATO",
      "publisher": "Microsoft",
      "rulePackId": "00000000-0000-0000-0000-000000000000"
    },
    {
      "name": "Australia Medicare Number",
      "id": "9ee8dba5-0e27-4847-a093-1fc69faf0a2c",
      "description": "Detects Australian Medicare card numbers - 10 or 11 digit numbers used for healthcare services",
      "publisher": "Microsoft",
      "rulePackId": "00000000-0000-0000-0000-000000000000"
    },
    {
      "name": "Australia Driver's License Number",
      "id": "1cbbc8f5-9216-4e2b-a6af-c35ab3b7fc2f",
      "description": "Detects Australian driver's licence numbers across all states and territories",
      "publisher": "Microsoft",
      "rulePackId": "00000000-0000-0000-0000-000000000000"
    }
  ],
  "policySettings": {
    "mode": "TestWithNotifications",
    "_modeOptions": [
      "Enable",
      "TestWithNotifications",
      "TestWithoutNotifications",
      "Disable"
    ],
    "priority": 0,
    "workloads": {
      "exchangeOnline": true,
      "sharePointOnline": true,
      "oneDriveForBusiness": true,
      "microsoftTeams": true,
      "endpointDevices": false,
      "onPremisesRepositories": false,
      "powerBI": false,
      "thirdPartyApps": false
    }
  },
  "overrideSettings": {
    "allowOverride": false,
    "requireBusinessJustification": false,
    "_note": "Australian PII must not be shared externally. No override permitted for Privacy Act 1988 compliance."
  }
}