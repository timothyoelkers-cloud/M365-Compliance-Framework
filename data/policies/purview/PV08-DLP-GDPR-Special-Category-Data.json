{
  "_metadata": {
    "id": "PV08",
    "title": "DLP - GDPR Article 9 Special Category Data",
    "description": "Data Loss Prevention policy for GDPR Article 9 special category data including health data, racial/ethnic origin, political opinions, religious beliefs, trade union membership, biometric data, and genetic data. Blocks external sharing and requires business justification for internal sharing overrides.",
    "version": "1.0",
    "lastUpdated": "2026-02-27",
    "frameworks": [
      "GDPR (EU) 2016/679",
      "NIS2",
      "ISO 27001:2022",
      "ISO 27701:2019",
      "NIST SP 800-53 Rev.5",
      "SOC 2",
      "DORA",
      "FedRAMP Moderate",
      "HITRUST CSF v11",
      "BSI IT-Grundschutz",
      "ENS (Spain) RD311/22",
      "HIPAA",
      "EU Cyber Resilience Act",
      "Microsoft Cloud Security Benchmark"
    ],
    "cisChecks": [
      "9.1.2",
      "9.1.3"
    ],
    "mitreMappings": [
      "T1048",
      "T1567",
      "T1041"
    ],
    "requiredLicences": [
      "Microsoft 365 E5 or E5 Compliance",
      "Microsoft Purview Data Loss Prevention add-on"
    ],
    "requiredRoles": [
      "Compliance Administrator",
      "Security Administrator",
      "Data Protection Officer"
    ],
    "deploymentOrder": 8,
    "importMethod": "powershell-security-compliance",
    "importScript": "scripts/Import-PurviewPolicies.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Connect to Security & Compliance PowerShell: Connect-IPPSSession",
      "GDPR Data Protection Impact Assessment (DPIA) should be completed",
      "Data Protection Officer must approve special category data handling rules",
      "Custom SITs for non-standard special categories may need to be created"
    ],
    "gdprArticle9Categories": [
      "Racial or ethnic origin",
      "Political opinions",
      "Religious or philosophical beliefs",
      "Trade union membership",
      "Genetic data",
      "Biometric data (for identification purposes)",
      "Health data",
      "Sex life or sexual orientation"
    ],
    "deploymentSteps": [
      "1. Create custom keyword dictionaries for special categories not covered by built-in SITs",
      "2. Create the DLP policy with EU GDPR template",
      "3. Create detection rules for each special category",
      "4. Test in simulation mode for 4 weeks (longer period due to sensitivity)",
      "5. Review with DPO and legal team",
      "6. Switch to enforcement mode"
    ],
    "rollbackProcedure": "Set-DlpCompliancePolicy -Identity 'PV08-DLP-GDPR-SpecialCategory' -Mode Disable"
  },
  "powershellCommands": {
    "createCustomKeywordDictionaries": [
      {
        "cmdlet": "New-DlpKeywordDictionary",
        "parameters": {
          "Name": "PV08-HealthDataKeywords",
          "Description": "Keywords indicating health/medical data for GDPR Article 9",
          "_keywords": [
            "diagnosis",
            "treatment plan",
            "medical record",
            "patient",
            "prescription",
            "blood type",
            "allergy",
            "medication",
            "surgery",
            "hospital admission",
            "clinical",
            "pathology",
            "radiology",
            "mental health",
            "disability",
            "chronic condition"
          ]
        }
      },
      {
        "cmdlet": "New-DlpKeywordDictionary",
        "parameters": {
          "Name": "PV08-SpecialCategoryKeywords",
          "Description": "Keywords indicating GDPR Article 9 special category data",
          "_keywords": [
            "ethnic origin",
            "ethnicity",
            "racial origin",
            "race",
            "political party",
            "political opinion",
            "political affiliation",
            "religious belief",
            "religion",
            "philosophical belief",
            "trade union",
            "union membership",
            "biometric",
            "fingerprint",
            "facial recognition",
            "retina scan",
            "genetic data",
            "DNA",
            "genome",
            "genetic test",
            "sexual orientation",
            "gender identity"
          ]
        }
      }
    ],
    "createPolicy": {
      "cmdlet": "New-DlpCompliancePolicy",
      "parameters": {
        "Name": "PV08-DLP-GDPR-SpecialCategory",
        "Comment": "GDPR Article 9 special category data protection. Blocks external sharing of health data, racial/ethnic origin, political opinions, religious beliefs, biometric data, and genetic data.",
        "ExchangeLocation": [
          "All"
        ],
        "SharePointLocation": [
          "All"
        ],
        "OneDriveLocation": [
          "All"
        ],
        "TeamsLocation": [
          "All"
        ],
        "Mode": "TestWithNotifications",
        "Priority": 7
      }
    },
    "createRuleHealthData": {
      "cmdlet": "New-DlpComplianceRule",
      "parameters": {
        "Name": "PV08-Rule-Block-HealthData-External",
        "Policy": "PV08-DLP-GDPR-SpecialCategory",
        "Comment": "Detect and block health data shared externally",
        "ContentContainsSensitiveInformation": [
          {
            "name": "International Classification of Diseases (ICD-10-CM)",
            "id": "3356946c-6bb7-449b-b253-6ffa419c0ce7",
            "minCount": 1,
            "minConfidence": 75,
            "maxConfidence": 100
          },
          {
            "name": "International Classification of Diseases (ICD-9-CM)",
            "id": "fa0f9141-0d09-4c29-bca5-0037e6f5fc4b",
            "minCount": 1,
            "minConfidence": 75,
            "maxConfidence": 100
          },
          {
            "name": "Drug Enforcement Agency (DEA) Number",
            "id": "d5b30b42-ecba-40c1-af3a-d6b9e5b79c97",
            "minCount": 1,
            "minConfidence": 75,
            "maxConfidence": 100
          }
        ],
        "AccessScope": "NotInOrganization",
        "BlockAccess": true,
        "BlockAccessScope": "ExternalUsers",
        "NotifyUser": [
          "SiteAdmin",
          "LastModifier"
        ],
        "NotifyPolicyTipCustomText": "This content contains health data classified as GDPR Article 9 special category data. External sharing is prohibited without explicit consent and DPO approval.",
        "NotifyOverride": "WithJustification",
        "GenerateIncidentReport": [],
        "IncidentReportContent": [
          "Title",
          "DocumentAuthor",
          "DocumentLastModifier",
          "Service",
          "MatchedItem",
          "RulesMatched",
          "Severity"
        ],
        "ReportSeverityLevel": "High"
      }
    },
    "createRuleSpecialCategories": {
      "cmdlet": "New-DlpComplianceRule",
      "parameters": {
        "Name": "PV08-Rule-Block-SpecialCategory-External",
        "Policy": "PV08-DLP-GDPR-SpecialCategory",
        "Comment": "Detect and block GDPR Article 9 special category personal data shared externally",
        "ContentContainsSensitiveInformation": [
          {
            "name": "EU National Identification Number",
            "id": "eec48844-2ecd-4f40-be8e-8e5e7bd64a1a",
            "minCount": 1,
            "minConfidence": 75,
            "maxConfidence": 100
          },
          {
            "name": "EU Social Security Number or Equivalent Identification",
            "id": "d3c4b82e-d4f2-489e-8d35-8d0e6f52395e",
            "minCount": 1,
            "minConfidence": 75,
            "maxConfidence": 100
          }
        ],
        "ContentContainsKeywordDictionary": {
          "Name": "PV08-SpecialCategoryKeywords",
          "minCount": 1
        },
        "AccessScope": "NotInOrganization",
        "BlockAccess": true,
        "BlockAccessScope": "ExternalUsers",
        "NotifyUser": [
          "SiteAdmin",
          "LastModifier"
        ],
        "NotifyPolicyTipCustomText": "This content contains GDPR Article 9 special category personal data (e.g., racial/ethnic origin, political opinions, religious beliefs, biometric or genetic data). External sharing requires explicit consent and DPO approval.",
        "NotifyOverride": "WithJustification",
        "GenerateIncidentReport": [],
        "IncidentReportContent": [
          "Title",
          "DocumentAuthor",
          "DocumentLastModifier",
          "Service",
          "MatchedItem",
          "RulesMatched",
          "Severity"
        ],
        "ReportSeverityLevel": "High"
      }
    }
  },
  "policySettings": {
    "mode": "TestWithNotifications",
    "priority": 7,
    "policyTemplate": "EU General Data Protection Regulation (GDPR)",
    "workloads": {
      "exchangeOnline": true,
      "sharePointOnline": true,
      "oneDriveForBusiness": true,
      "microsoftTeams": true
    }
  },
  "overrideSettings": {
    "allowOverride": true,
    "requireBusinessJustification": true,
    "_note": "Override with mandatory GDPR-compliant justification. All overrides are logged and reported to the DPO."
  }
}