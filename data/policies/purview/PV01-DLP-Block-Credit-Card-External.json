{
  "_metadata": {
    "id": "PV01",
    "title": "DLP - Block Credit Card Numbers Shared Externally",
    "description": "Data Loss Prevention policy that detects and blocks credit card numbers (Visa, Mastercard, Amex, Discover, and other major card types) from being shared with external recipients across Exchange, SharePoint, OneDrive, and Teams.",
    "version": "1.0",
    "lastUpdated": "2026-02-27",
    "frameworks": [
      "NIS2",
      "ISO 27001:2022",
      "ISO 27701:2019",
      "NIST SP 800-53 Rev.5",
      "SOC 2",
      "GDPR (EU) 2016/679",
      "PCI DSS v4.0",
      "FedRAMP Moderate",
      "HITRUST CSF v11",
      "BSI IT-Grundschutz",
      "DORA",
      "HIPAA",
      "CMMC v2.0",
      "NYDFS 23 NYCRR 500",
      "Microsoft Cloud Security Benchmark",
      "MITRE ATT&CK"
    ],
    "cisChecks": [
      "9.1.1",
      "9.1.2",
      "9.1.3",
      "9.1.5"
    ],
    "mitreMappings": [
      "T1048",
      "T1567",
      "T1041"
    ],
    "requiredLicences": [
      "Microsoft 365 E3 (basic DLP)",
      "Microsoft 365 E5 or Microsoft 365 E5 Compliance (advanced DLP)",
      "Microsoft Purview Data Loss Prevention add-on"
    ],
    "requiredRoles": [
      "Compliance Administrator",
      "Security Administrator"
    ],
    "deploymentOrder": 1,
    "importMethod": "powershell-security-compliance",
    "importScript": "scripts/Import-PurviewPolicies.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Connect to Security & Compliance PowerShell: Connect-IPPSSession",
      "DLP licensing must be assigned to all users in scope",
      "Deploy in TestWithNotifications mode first, then switch to Enable after validation",
      "Ensure Exchange Online, SharePoint Online, and Teams services are active"
    ],
    "deploymentSteps": [
      "1. Connect to Security & Compliance PowerShell",
      "2. Run the New-DlpCompliancePolicy cmdlet to create the policy",
      "3. Run the New-DlpComplianceRule cmdlet to create the detection rule",
      "4. Set Mode to TestWithNotifications for initial 2-week pilot",
      "5. Review DLP reports in compliance.microsoft.com > Reports > DLP",
      "6. After validation, change Mode to Enable for enforcement"
    ],
    "rollbackProcedure": "Set-DlpCompliancePolicy -Identity 'PV01-DLP-Block-CreditCard-External' -Mode Disable"
  },
  "powershellCommands": {
    "createPolicy": {
      "cmdlet": "New-DlpCompliancePolicy",
      "parameters": {
        "Name": "PV01-DLP-Block-CreditCard-External",
        "Comment": "Blocks credit card numbers from being shared externally across Exchange, SharePoint, OneDrive, and Teams. PCI DSS compliance.",
        "ExchangeLocation": [
          "All"
        ],
        "SharePointLocation": [
          "All"
        ],
        "OneDriveLocation": [
          "All"
        ],
        "TeamsLocation": [
          "All"
        ],
        "Mode": "TestWithNotifications",
        "Priority": 0
      }
    },
    "createRule": {
      "cmdlet": "New-DlpComplianceRule",
      "parameters": {
        "Name": "PV01-Rule-Block-CreditCard-External",
        "Policy": "PV01-DLP-Block-CreditCard-External",
        "ContentContainsSensitiveInformation": [
          {
            "name": "Credit Card Number",
            "id": "50842eb7-edc8-4019-85dd-5a5c1f2bb085",
            "minCount": 1,
            "maxCount": -1,
            "minConfidence": 75,
            "maxConfidence": 100,
            "_note": "Detects all major card brands: Visa, Mastercard, Amex, Discover, JCB, Diners Club, UnionPay"
          }
        ],
        "AccessScope": "NotInOrganization",
        "BlockAccess": true,
        "BlockAccessScope": "ExternalUsers",
        "NotifyUser": [
          "SiteAdmin",
          "LastModifier"
        ],
        "NotifyUserType": "NotifyAll",
        "NotifyPolicyTipCustomText": "This content contains credit card information and cannot be shared externally. Please remove the sensitive data or contact your compliance team for assistance.",
        "GenerateAlert": "SiteAdmin",
        "AlertProperties": {
          "AggregationType": "SimpleAggregation",
          "Threshold": 1,
          "TimeWindow": 60
        },
        "GenerateIncidentReport": [],
        "IncidentReportContent": [
          "Title",
          "DocumentAuthor",
          "DocumentLastModifier",
          "Service",
          "MatchedItem",
          "RulesMatched",
          "Severity"
        ],
        "ReportSeverityLevel": "High"
      }
    }
  },
  "sensitiveInformationTypes": [
    {
      "name": "Credit Card Number",
      "id": "50842eb7-edc8-4019-85dd-5a5c1f2bb085",
      "description": "Detects all major credit card formats: Visa (4xxx), MC (5xxx/2xxx), Amex (3xxx), Discover (6xxx), JCB, Diners Club",
      "publisher": "Microsoft",
      "rulePackId": "00000000-0000-0000-0000-000000000000"
    }
  ],
  "policySettings": {
    "mode": "TestWithNotifications",
    "_modeOptions": [
      "Enable",
      "TestWithNotifications",
      "TestWithoutNotifications",
      "Disable"
    ],
    "priority": 0,
    "workloads": {
      "exchangeOnline": true,
      "sharePointOnline": true,
      "oneDriveForBusiness": true,
      "microsoftTeams": true,
      "endpointDevices": false,
      "onPremisesRepositories": false,
      "powerBI": false,
      "thirdPartyApps": false
    }
  },
  "overrideSettings": {
    "allowOverride": false,
    "requireBusinessJustification": false,
    "_note": "Credit card data should never be shared externally. No override permitted for PCI DSS compliance."
  }
}