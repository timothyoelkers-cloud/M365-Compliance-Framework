{
  "_metadata": {
    "id": "PV22",
    "title": "Retention Policy - All Workloads 7-Year Retention",
    "description": "Organisation-wide retention policy that retains content for 7 years (2555 days) then deletes across Exchange Online, SharePoint Online, OneDrive for Business, Teams channels, and Teams chats. Provides baseline data governance and regulatory compliance for records retention obligations.",
    "version": "1.0",
    "lastUpdated": "2026-02-28",
    "frameworks": [
      "NIS2",
      "ISO 27001:2022",
      "NIST SP 800-53 Rev.5",
      "GDPR (EU) 2016/679",
      "HIPAA",
      "PCI DSS v4.0",
      "SOC 2",
      "DORA",
      "FedRAMP Moderate",
      "CMMC v2.0",
      "HITRUST CSF v11",
      "NYDFS 23 NYCRR 500",
      "UK NCSC CAF v3.2",
      "BSI IT-Grundschutz",
      "Microsoft Cloud Security Benchmark",
      "ASD Essential Eight",
      "NERC-CIP",
      "SEC Cyber Rule"
    ],
    "cisChecks": [
      "9.1.12"
    ],
    "mitreMappings": [],
    "requiredLicences": [
      "Microsoft 365 E3 or E5",
      "Microsoft 365 E5 Compliance (for advanced retention features)",
      "Exchange Online Plan 2 (alternative for Exchange-only retention)"
    ],
    "requiredRoles": [
      "Compliance Administrator"
    ],
    "deploymentOrder": 22,
    "importMethod": "powershell-security-compliance",
    "importScript": "scripts/Import-PurviewPolicies.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Connect to Security & Compliance PowerShell: Connect-IPPSSession",
      "Retention licensing must be assigned to all users in scope",
      "Ensure Exchange Online, SharePoint Online, OneDrive, and Teams services are active",
      "Review existing retention policies to avoid conflicts or overlapping scopes",
      "Coordinate with legal and compliance teams on 7-year retention requirement"
    ],
    "retentionDetails": {
      "retentionPeriod": "7 years (2555 days)",
      "retentionAction": "KeepAndDelete",
      "retentionBasis": "Content creation date",
      "scope": "Organisation-wide across all supported workloads",
      "_note": "KeepAndDelete means content is retained for 7 years from creation, then automatically deleted after the retention period expires"
    },
    "deploymentSteps": [
      "1. Connect to Security & Compliance PowerShell",
      "2. Review existing retention policies for conflicts",
      "3. Run New-RetentionCompliancePolicy to create the org-wide policy",
      "4. Run New-RetentionComplianceRule to set the 7-year retention duration",
      "5. Verify policy status in compliance.microsoft.com > Data lifecycle management",
      "6. Monitor retention policy distribution status (may take up to 24 hours)"
    ],
    "rollbackProcedure": "Remove-RetentionCompliancePolicy -Identity 'PV22-Retention-AllWorkloads-7Years' -ForceDeletion. Note: content already under retention will remain until the original retention period expires unless a new policy overrides it."
  },
  "powershellCommands": {
    "createPolicy": {
      "cmdlet": "New-RetentionCompliancePolicy",
      "parameters": {
        "Name": "PV22-Retention-AllWorkloads-7Years",
        "Comment": "Organisation-wide retention policy. Retains content for 7 years then deletes across Exchange, SharePoint, OneDrive, and Teams. CIS 9.1.12 compliance.",
        "ExchangeLocation": [
          "All"
        ],
        "SharePointLocation": [
          "All"
        ],
        "OneDriveLocation": [
          "All"
        ],
        "TeamsChannelLocation": [
          "All"
        ],
        "TeamsChatLocation": [
          "All"
        ],
        "Enabled": true
      }
    },
    "createRule": {
      "cmdlet": "New-RetentionComplianceRule",
      "parameters": {
        "Name": "PV22-Rule-Retain-7Years",
        "Policy": "PV22-Retention-AllWorkloads-7Years",
        "RetentionDuration": 2555,
        "RetentionDurationDisplayHint": "Years",
        "RetentionAction": "KeepAndDelete",
        "ExpirationDateOption": "CreatedDate"
      }
    },
    "verifyPolicy": {
      "cmdlet": "Get-RetentionCompliancePolicy",
      "parameters": {
        "Identity": "PV22-Retention-AllWorkloads-7Years",
        "DistributionDetail": true
      },
      "expectedResult": "Policy exists with DistributionStatus of Success for all workloads"
    },
    "verifyRule": {
      "cmdlet": "Get-RetentionComplianceRule",
      "parameters": {
        "Policy": "PV22-Retention-AllWorkloads-7Years"
      },
      "expectedResult": "Rule with RetentionDuration 2555 and RetentionAction KeepAndDelete"
    }
  },
  "policySettings": {
    "retentionDuration": "2555 days (7 years)",
    "retentionAction": "KeepAndDelete",
    "expirationDateOption": "CreatedDate",
    "scope": "organisationWide",
    "workloads": {
      "exchangeOnline": true,
      "sharePointOnline": true,
      "oneDriveForBusiness": true,
      "teamsChannelMessages": true,
      "teamsChatMessages": true,
      "vivaEngage": false,
      "exchangePublicFolders": false
    }
  },
  "complianceMappings": {
    "cis": "CIS M365 9.1.12: Ensure a retention policy exists for all Microsoft 365 workloads",
    "gdpr": "GDPR Article 5(1)(e): Storage limitation - data kept no longer than necessary",
    "hipaa": "HIPAA 164.530(j): Retention of documentation for 6 years minimum",
    "pciDss": "PCI DSS v4.0 Req 3.1: Data retention and disposal policies",
    "soc2": "SOC 2 CC6.5: Secure disposal of data after retention period",
    "nis2": "NIS2 Article 21: Security of information systems including data lifecycle management",
    "secCyberRule": "SEC Cyber Rule: Retention of records for regulatory examination"
  }
}