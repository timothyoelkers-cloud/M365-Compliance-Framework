{
  "_metadata": {
    "id": "ENT03",
    "title": "Block Users from Creating App Registrations",
    "description": "Disables the ability for non-admin users to register new applications (app registrations) in Entra ID. Prevents shadow IT and unapproved SaaS integrations with corporate M365 data.",
    "version": "1.0",
    "lastUpdated": "2026-02-27",
    "frameworks": [
      "NIS2",
      "ISO 27001:2022",
      "NIST SP 800-53 Rev.5",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "GDPR (EU) 2016/679",
      "FedRAMP Moderate",
      "HITRUST CSF v11",
      "BSI IT-Grundschutz",
      "DORA",
      "CMMC v2.0",
      "ASD Essential Eight",
      "MITRE ATT&CK",
      "Microsoft Cloud Security Benchmark",
      "CJIS v6",
      "EU Cyber Resilience Act"
    ],
    "cisChecks": [
      "5.1.2.2"
    ],
    "mitreMappings": [
      "T1098.003",
      "T1550.001",
      "T1528"
    ],
    "requiredLicences": [
      "Microsoft Entra ID Free (included with any M365 plan)"
    ],
    "requiredRoles": [
      "Global Administrator",
      "Privileged Role Administrator"
    ],
    "deploymentOrder": 3,
    "importMethod": "powershell-graph",
    "importScript": "scripts/Import-EntraSettings.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Global Administrator or Privileged Role Administrator role required",
      "Communicate to developers/IT that app registrations must go through an approved process",
      "Establish an app registration request process (e.g., ServiceNow ticket) before deploying"
    ],
    "deploymentSteps": [
      "1. Audit existing user-created app registrations",
      "2. Establish an approved app registration request process",
      "3. Apply the Graph API PATCH to disable user app registrations",
      "4. Verify the change",
      "5. Communicate the new process to development teams"
    ],
    "rollbackProcedure": "PATCH /policies/authorizationPolicy with allowedToCreateApps: true"
  },
  "graphApiCalls": [
    {
      "stepOrder": 1,
      "description": "Disable users from creating app registrations",
      "method": "PATCH",
      "endpoint": "https://graph.microsoft.com/v1.0/policies/authorizationPolicy",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer "
      },
      "body": {
        "defaultUserRolePermissions": {
          "allowedToCreateApps": false
        }
      },
      "_explanation": "Setting allowedToCreateApps to false prevents non-admin users from creating new application registrations in Entra ID. Only users with Application Administrator, Cloud Application Administrator, or Application Developer roles can create registrations."
    },
    {
      "stepOrder": 2,
      "description": "Verify that users cannot create app registrations",
      "method": "GET",
      "endpoint": "https://graph.microsoft.com/v1.0/policies/authorizationPolicy",
      "expectedResponse": {
        "defaultUserRolePermissions": {
          "allowedToCreateApps": false
        }
      }
    }
  ],
  "powershellAlternative": {
    "module": "Microsoft.Graph",
    "commands": [
      {
        "description": "Connect to Microsoft Graph",
        "command": "Connect-MgGraph -Scopes 'Policy.ReadWrite.Authorization'"
      },
      {
        "description": "Disable user app registration",
        "command": "Update-MgPolicyAuthorizationPolicy -DefaultUserRolePermissions @{ AllowedToCreateApps = $false }"
      },
      {
        "description": "Verify the change",
        "command": "(Get-MgPolicyAuthorizationPolicy).DefaultUserRolePermissions.AllowedToCreateApps"
      }
    ]
  },
  "entraPortalPath": {
    "navigation": "Entra admin center > Identity > Users > User settings",
    "setting": "Users can register applications: No"
  }
}