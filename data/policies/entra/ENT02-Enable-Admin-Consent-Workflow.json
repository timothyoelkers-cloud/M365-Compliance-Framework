{
  "_metadata": {
    "id": "ENT02",
    "title": "Enable Admin Consent Workflow",
    "description": "Enables the admin consent request workflow so that users who need access to applications that require organizational permissions can submit a request for admin review. Provides a governed process to complement ENT01 (disabled user consent).",
    "version": "1.0",
    "lastUpdated": "2026-02-27",
    "frameworks": [
      "NIS2",
      "ISO 27001:2022",
      "NIST SP 800-53 Rev.5",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "GDPR (EU) 2016/679",
      "FedRAMP Moderate",
      "HITRUST CSF v11",
      "BSI IT-Grundschutz",
      "DORA",
      "ASD Essential Eight",
      "MITRE ATT&CK",
      "Microsoft Cloud Security Benchmark",
      "CJIS v6",
      "EU Cyber Resilience Act"
    ],
    "cisChecks": [
      "5.1.5.2"
    ],
    "mitreMappings": [
      "T1550.001",
      "T1528"
    ],
    "requiredLicences": [
      "Microsoft Entra ID Free (included with any M365 plan)"
    ],
    "requiredRoles": [
      "Global Administrator",
      "Privileged Role Administrator"
    ],
    "deploymentOrder": 2,
    "importMethod": "powershell-graph",
    "importScript": "scripts/Import-EntraSettings.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Deploy ENT01 (Disable User Consent) first or simultaneously",
      "Identify admin reviewers who will approve or deny consent requests",
      "Reviewer group must include users with Cloud Application Administrator or Application Administrator role",
      "Global Administrator or Privileged Role Administrator required to configure"
    ],
    "deploymentSteps": [
      "1. Create or identify the reviewer group in Entra ID",
      "2. Apply the Graph API PATCH to enable the admin consent workflow",
      "3. Configure notification and reminder settings",
      "4. Test by requesting consent as a regular user",
      "5. Monitor the admin consent request queue regularly"
    ],
    "rollbackProcedure": "PATCH /policies/adminConsentRequestPolicy with isEnabled: false"
  },
  "graphApiCalls": [
    {
      "stepOrder": 1,
      "description": "Enable admin consent workflow with reviewer notifications and reminders",
      "method": "PATCH",
      "endpoint": "https://graph.microsoft.com/v1.0/policies/adminConsentRequestPolicy",
      "headers": {
        "Content-Type": "application/json",
        "Authorization": "Bearer "
      },
      "body": {
        "isEnabled": true,
        "notifyReviewers": true,
        "remindersEnabled": true,
        "requestDurationInDays": 30,
        "reviewers": [
          {
            "query": "/users/",
            "queryType": "MicrosoftGraph",
            "queryRoot": null
          },
          {
            "query": "/groups//members",
            "queryType": "MicrosoftGraph",
            "queryRoot": null
          }
        ]
      },
      "_explanation": "Enables the workflow, sends notifications to designated reviewers, enables periodic reminders, and auto-expires requests after 30 days if not acted upon."
    },
    {
      "stepOrder": 2,
      "description": "Verify the admin consent workflow is enabled",
      "method": "GET",
      "endpoint": "https://graph.microsoft.com/v1.0/policies/adminConsentRequestPolicy",
      "expectedResponse": {
        "isEnabled": true,
        "notifyReviewers": true,
        "remindersEnabled": true,
        "requestDurationInDays": 30
      }
    }
  ],
  "powershellAlternative": {
    "module": "Microsoft.Graph",
    "commands": [
      {
        "description": "Connect to Microsoft Graph with required permissions",
        "command": "Connect-MgGraph -Scopes 'Policy.ReadWrite.ConsentRequest'"
      },
      {
        "description": "Enable the admin consent workflow",
        "command": "Update-MgPolicyAdminConsentRequestPolicy -IsEnabled -NotifyReviewers -RemindersEnabled -RequestDurationInDays 30 -Reviewers @(@{Query='/groups//members'; QueryType='MicrosoftGraph'})"
      },
      {
        "description": "Verify the configuration",
        "command": "Get-MgPolicyAdminConsentRequestPolicy | Select-Object IsEnabled, NotifyReviewers, RemindersEnabled, RequestDurationInDays"
      }
    ]
  },
  "entraPortalPath": {
    "navigation": "Entra admin center > Identity > Applications > Enterprise applications > Consent and permissions > Admin consent settings",
    "settings": {
      "usersCanRequestAdminConsentToApps": true,
      "selectedUsersToReviewConsentRequests": "",
      "consentRequestExpiresDays": 30,
      "emailNotifications": true,
      "reminderNotifications": true
    }
  }
}