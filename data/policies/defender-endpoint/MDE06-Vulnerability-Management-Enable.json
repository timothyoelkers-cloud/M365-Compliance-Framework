{
  "_metadata": {
    "id": "MDE06",
    "title": "Enable Defender Vulnerability Management",
    "description": "Enables Microsoft Defender Vulnerability Management (TVM) for continuous vulnerability assessment, software inventory, security recommendations, and risk-based prioritisation across all onboarded endpoints.",
    "version": "1.0",
    "lastUpdated": "2026-02-27",
    "frameworks": [
      "NIS2",
      "DORA",
      "ISO 27001:2022",
      "NIST SP 800-53 Rev.5",
      "UK NCSC CAF v3.2",
      "SOC 2",
      "PCI DSS v4.0",
      "HIPAA",
      "FedRAMP Moderate",
      "HITRUST CSF v11",
      "BSI IT-Grundschutz",
      "ASD Essential Eight",
      "NZ ISM v3.8",
      "MITRE ATT&CK",
      "Microsoft Cloud Security Benchmark",
      "NIST CSF 2.0",
      "CMMC v2.0",
      "NERC-CIP",
      "CJIS v6"
    ],
    "cisChecks": [
      "5.1.4.1",
      "5.1.4.2"
    ],
    "mitreMappings": [
      "T1190",
      "T1210",
      "T1068",
      "T1203"
    ],
    "requiredLicences": [
      "Microsoft Defender for Endpoint P2",
      "Microsoft Defender Vulnerability Management add-on (for premium capabilities)",
      "Microsoft 365 E5 or Microsoft 365 E5 Security"
    ],
    "requiredRoles": [
      "Security Administrator",
      "Security Reader"
    ],
    "deploymentOrder": 6,
    "importMethod": "powershell-graph",
    "importScript": "scripts/Import-DefenderEndpointPolicies.ps1"
  },
  "_notes": {
    "prerequisites": [
      "Devices must be onboarded to Microsoft Defender for Endpoint (MDE01-MDE03)",
      "MDE P2 licence provides core TVM features; premium add-on provides additional capabilities",
      "For authenticated scans, a scan service account is required",
      "Network device scanning requires SNMP configuration"
    ],
    "capabilities": {
      "coreTvm": [
        "Software inventory and vulnerability discovery",
        "Security recommendations with risk-based prioritisation",
        "Exposure score and device secure score",
        "Remediation tracking and exception management",
        "Browser extension inventory"
      ],
      "premiumAddOn": [
        "Certificate inventory assessment",
        "Network share analysis",
        "Firmware vulnerability assessment",
        "Authenticated scan for Windows",
        "CIS benchmark assessment",
        "Block vulnerable applications"
      ]
    },
    "deploymentSteps": [
      "1. Verify device onboarding is complete (MDE01-MDE03)",
      "2. Navigate to security.microsoft.com > Vulnerability management",
      "3. Review the Dashboard for initial vulnerability discovery results",
      "4. Configure authenticated scans for deeper vulnerability assessment",
      "5. Set up remediation request workflows to ServiceNow or Intune",
      "6. Configure baseline assessment profiles"
    ],
    "rollbackProcedure": "TVM is a built-in capability of MDE P2 and cannot be individually disabled. Removing device onboarding removes TVM coverage."
  },
  "vulnerabilityManagementSettings": {
    "portalUrl": "https://security.microsoft.com/tvm",
    "features": {
      "softwareInventory": {
        "enabled": true,
        "includeOpenSource": true,
        "includeBrowserExtensions": true,
        "includeNetworkDevices": true
      },
      "vulnerabilityAssessment": {
        "enabled": true,
        "continuousAssessment": true,
        "scanFrequency": "continuous",
        "includeOsVulnerabilities": true,
        "includeSoftwareVulnerabilities": true,
        "includeFirmwareVulnerabilities": true
      },
      "securityRecommendations": {
        "enabled": true,
        "riskBasedPrioritisation": true,
        "exposedDeviceThreshold": 10
      },
      "remediationTracking": {
        "enabled": true,
        "integrateWithIntune": true,
        "createSecurityTasks": true
      }
    }
  },
  "authenticatedScanConfig": {
    "graphApiEndpoint": "https://api.securitycenter.microsoft.com/api/DeviceAuthenticatedScanDefinitions",
    "method": "POST",
    "scanDefinition": {
      "scanName": "MDE06 - Authenticated Vulnerability Scan - Windows",
      "scanType": "Windows",
      "isActive": true,
      "target": {
        "deviceGroupIds": []
      },
      "scanAuthenticationParams": {
        "@odata.type": "#microsoft.windowsDefenderSecurity.api.WindowsAuthParams",
        "type": "kerberos",
        "keyVaultUrl": "",
        "keyVaultSecretName": ""
      },
      "scannerAgent": {
        "machineId": "",
        "machineName": ""
      }
    }
  },
  "baselineAssessmentProfiles": [
    {
      "profileName": "CIS Windows 11 Enterprise L1",
      "benchmark": "CIS",
      "benchmarkVersion": "3.0",
      "operatingSystem": "Windows11Enterprise",
      "complianceLevel": "Level1",
      "enabled": true,
      "targetDeviceGroups": []
    },
    {
      "profileName": "CIS Windows Server 2022 L1",
      "benchmark": "CIS",
      "benchmarkVersion": "2.0",
      "operatingSystem": "WindowsServer2022",
      "complianceLevel": "Level1",
      "enabled": true,
      "targetDeviceGroups": []
    }
  ],
  "blockVulnerableApplications": {
    "_description": "Premium feature: Block execution of known vulnerable application versions",
    "enabled": true,
    "action": "warn",
    "minimumSeverity": "critical",
    "applicationsToBlock": [],
    "_note": "Specific applications are configured via the TVM portal based on vulnerability severity"
  }
}